// pipeline {
//   environment {
//     registry = "frankiewfli/qrcoderedemption"
//     registryCredential = 'dockerhub'
//     dockerImage = ''
//   }
//   agent any
//   stages {
//     stage('Cloning Git') {
//       steps {
//        echo  'which docker' 
//         git 'https://github.com/mrwfli/qrcoderedemption.git'
//       }
//     }
//     stage('Building image') {
//       steps{
//         script {
//          // dockerImage = docker.build registry + ":$BUILD_NUMBER"
//              sh "docker-compose build"
//         }
//       }
//     }
//     stage('Deploy Image') {
//       steps{
//         script {
//           docker.withRegistry( '', registryCredential ) {
//             dockerImage.push()
//           }
//         }
//       }
//     }
//     stage('Remove Unused docker image') {
//       steps{
//         sh "docker rmi $registry:$BUILD_NUMBER"
//       }
//     }
//   }
// }

node {
    checkout scm

    docker.withRegistry('https://registry.hub.docker.com', 'dockerhub') {

        def customImage = docker.build("frankiewfli/qrcoderedemption")

        /* Push the container to the custom Registry */
        customImage.push()
    }
}